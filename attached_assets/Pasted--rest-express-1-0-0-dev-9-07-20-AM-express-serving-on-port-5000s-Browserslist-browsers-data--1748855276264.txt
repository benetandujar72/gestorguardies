
> rest-express@1.0.0 dev
9:07:20 AM [express] serving on port 5000s
Browserslist: browsers data (caniuse-lite) is 8 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
9:07:30 AM [express] GET /api/auth/user 304 in 468ms :: {"id":"36895369","email":"benet.andujar@insb…
9:07:30 AM [express] GET /api/anys-academics 304 in 177ms :: [{"id":3,"nom":"2026-2027","dataInici":…
9:07:30 AM [express] GET /api/assignacions-guardia 304 in 375ms :: [{"id":17,"anyAcademicId":2,"guar…
9:07:30 AM [express] GET /api/sortides 304 in 422ms :: [{"id":18,"nomSortida":"Laboratori de química…
9:07:30 AM [express] GET /api/metrics 200 in 122ms
9:07:30 AM [express] GET /api/guardies 304 in 449ms :: [{"id":17,"data":"2025-06-02","horaInici":"08…
9:07:30 AM [express] GET /api/tasques 304 in 484ms :: []
9:07:31 AM [express] GET /api/analytics/workload-balance 304 in 537ms :: [{"professorId":149,"guardC…
9:07:31 AM [express] GET /api/guardies 304 in 235ms :: [{"id":17,"data":"2025-06-02","horaInici":"08…
9:07:36 AM [express] GET /api/sortides 304 in 240ms :: [{"id":18,"nomSortida":"Laboratori de química…
=== INICI RUTA CLASSES-SUBSTITUIR ===
sortidaId: 18
activeYear: {
  id: 2,
  nom: '2025-2026',
  dataInici: '2025-09-01',
  dataFi: '2026-06-19',
  estat: 'actiu',
  observacions: 'Curs acadèmic 2025-2026\n',
  createdAt: 2025-05-30T17:39:29.575Z
}
Cridant getClassesToSubstitute amb: { sortidaId: 18, anyAcademicId: 2 }
Buscant substitucions per sortida 18, any acadèmic 2
Sortida trobada: Laboratori de química aplicada, responsable: 182
Dates: 2025-06-05 08:19:00 - 2025-06-05 12:19:00
Dia de la setmana afectat: 4
Horari afectat: 08:19:00 - 12:19:00
Consulta SQL executada per professor 182, dia 4, 08:19:00-12:19:00
Trobades 4 classes a substituir
Resultat getClassesToSubstitute: [
  {
    id: 2497,
    professorId: 182,
    grupId: 45,
    aulaId: null,
    diaSetmana: 4,
    horaInici: '11:30:00',
    horaFi: '12:30:00',
    assignatura: null,
    professor: { id: 182, nom: 'BA', cognoms: 'BA' },
    grup: { id: 45, nomGrup: '3r ESO C' },
    aula: null
  },
  {
    id: 2483,
    professorId: 182,
    grupId: 45,
    aulaId: null,
    diaSetmana: 4,
    horaInici: '10:00:00',
    horaFi: '11:00:00',
    assignatura: null,
    professor: { id: 182, nom: 'BA', cognoms: 'BA' },
    grup: { id: 45, nomGrup: '3r ESO C' },
    aula: null
  },
  {
    id: 2468,
    professorId: 182,
    grupId: 43,
    aulaId: null,
    diaSetmana: 4,
    horaInici: '09:00:00',
    horaFi: '10:00:00',
    assignatura: null,
    professor: { id: 182, nom: 'BA', cognoms: 'BA' },
    grup: { id: 43, nomGrup: '3r ESO A' },
    aula: null
  },
  {
    id: 2455,
    professorId: 182,
    grupId: 43,
    aulaId: null,
    diaSetmana: 4,
    horaInici: '08:00:00',
    horaFi: '09:00:00',
    assignatura: null,
    professor: { id: 182, nom: 'BA', cognoms: 'BA' },
    grup: { id: 43, nomGrup: '3r ESO A' },
    aula: null
  }
]
9:07:37 AM [express] GET /api/sortides/18/classes-substituir 304 in 300ms :: [{"id":2497,"professorI…
=== INICI RUTA PROFESSORS-DISPONIBLES ===
horariId: 2497
activeYear: 2
activeYear type: number
anyAcademicId final: 2
=== BÚSQUEDA PROFESSORS SUBSTITUCIÓ ===
Horari: 2497, Any: 2
Classe: 3r ESO C, Professor: BA BA
Dia: 4, Hora: 11:30:00-12:30:00
--- Cercant professors amb guàrdia programada ---
Trobats 0 professors amb guàrdia
--- Cercant professors lliures ---
Trobats 39 professors lliures
--- Cercant professors amb reunions/càrrecs ---
Error en getProfessorsAvailableForSubstitution: error: invalid input syntax for type integer: "149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,183,184,185,186,187,188"
    at file:///home/runner/workspace/node_modules/@neondatabase/serverless/index.mjs:1345:74
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async DatabaseStorage.getProfessorsAvailableForSubstitution (/home/runner/workspace/server/storage.ts:1302:40)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:1801:35) {
  length: 298,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $7 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '617',
  routine: 'pg_strtoint32_safe'
}
Resultat professors disponibles: 0 professors
9:07:40 AM [express] GET /api/horari/2497/professors-disponibles 304 in 421ms :: []